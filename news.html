<!DOCTYPE html>
<html>

<head>
        <title>My Syllabus | News</title>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
      
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
          crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
          crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
          crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

        <script src="https://www.gstatic.com/firebasejs/5.7.0/firebase.js"></script>
      
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
          crossorigin="anonymous">
        <link rel="shortcut icon" href="image/MYS.ico" />
        <link href="css/login.css" rel="stylesheet">
        <link href="css/news.css" rel="stylesheet">
        <link href="css/loader.css" rel="stylesheet">    
</head>

<body onload="myFunction()" style="margin:0;">

    <div id="loader"></div>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <a class="navbar-brand" href="index.html">My Syllabus</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
              aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
        
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item ">
                  <a class="nav-link" href="home.html">Home</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="course.html">Course</a>
                </li>
                <li class="nav-item active">
                  <a class="nav-link" href="news.html">News</a>
                </li>
                <li class="nav-item dropdown">
                  <a id="emailNav" class="hide nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
                    User
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                      <a class="dropdown-item" href="mycourse.html">My Course</a>
                  </div>
                </li>
              </ul>
              <form class="form-inline my-2 my-lg-0">
                <input id="signInBtn" class="btn btn-outline-success my-2 my-sm-0" type="button" value="Login" onclick="document.getElementById('loginmodal').style.display='block'"
                  style="width:auto;" />
                <input id="signOutBtn" class="btn btn-outline-danger my-2 my-sm-0 hide" type="button" value="Logout"
                  style="width:auto;" />
              </form>
            </div>
          </nav>

    <div style="display:none;" id="myDiv" class="animate-bottom">
        
  <!-- LOGIN -->
  <div id="loginmodal" class="modal">
        <form class="modal-content-login animate" action="home.html">
            <div class="container">
                <h4 style="text-align: center">Login</h4>
                <input id="emailLogin" type="text" placeholder="Email">
                <input id="passwordLogin" type="password" placeholder="Password">
                <button id="loginBtn" class="allbutton btn-success" type="button">Login</button>
                <hr>
                <button type="button" class="btn btn-danger" onclick="document.getElementById('loginmodal').style.display='none'">Cancel</button>
                <span class="psw" onclick="document.getElementById('regismodal').style.display='block'"> <a href="#">Create account</a></span>
            </div>
        </form>
    </div>
    <!-- REGISTER -->
    <div id="regismodal" class="regform">
      <form class="reg-wrap animate">
        <div class="regcontainer">
          <h4 style="text-align: center">Register</h4>
          <hr>
          <input id="fname" type="text" placeholder="First Name">
          <input id="lname" type="text" placeholder="Last Name">
          <input id="ID" type="text" placeholder="Student ID">
          <input id="email" type="text" placeholder="Email">
          <input id="password" type="password" placeholder="Password">
          <button id="regis" class="allbutton" >Submit</button>
          <hr>
          <button type="button" class="btn btn-danger" onclick="document.getElementById('regismodal').style.display='none'">Cancel</button>
        </div>
      </form>
    </div>

        <div class="container">
            <!-- HEAD -->
            <div class="jumbotron p-3 p -md-5 text-white rounded bg-dark">
                <div class="col-md-6 px-0">
                    <h1 class="display-4 font-italic">KKU NEWS</h1>
                    <a>What happen in our university now? you don't want to miss it.</a>
                </div>
            </div>

            <div class="row mb-2">

                <div class="col-md-6">
                    <div class="card flex-md-row mb-4 shadow-sm h-md-250">
                        <div class="card-body d-flex flex-column align-items-start">
                            <strong id="firstid" class="d-inline-block mb-2 text-primary">1</strong>
                            <h4 class="mb-0">
                                <a id="firstnewstitle" class="text-dark">NEWS TITLE</a>
                            </h4>
                            <div id="firstdate" class="mb-1 text-muted">DATE</div>
                            <a id="firstnewslink" href="#" target="_blank">Continue reading</a>
                        </div>
                        <img id="firstnews" class="card-img-right flex-auto d-none d-lg-block" data-src="holder.js/200x250?theme=thumb">
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card flex-md-row mb-4 shadow-sm h-md-250">
                        <div class="card-body d-flex flex-column align-items-start">
                            <strong id="secondid" class="d-inline-block mb-2 text-primary">2</strong>
                            <h4 class="mb-0">
                                <a id="secondnewstitle" class="text-dark">NEWS TITLE</a>
                            </h4>
                            <div id="seconddate" class="mb-1 text-muted">DATE</div>
                            <a id="secondnewslink" href="#" target="_blank">Continue reading</a>
                        </div>
                        <img id="secondnews" class="card-img-right flex-auto d-none d-lg-block" data-src="holder.js/200x250?theme=thumb">
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card flex-md-row mb-4 shadow-sm h-md-250">
                        <div class="card-body d-flex flex-column align-items-start">
                            <strong id="thirdid" class="d-inline-block mb-2 text-primary">3</strong>
                            <h4 class="mb-0">
                                <a id="thirdnewstitle" class="text-dark">NEWS TITLE</a>
                            </h4>
                            <div id="thirddate" class="mb-1 text-muted">DATE</div>
                            <a id="thirdnewslink" href="#" target="_blank">Continue reading</a>
                        </div>
                        <img id="thirdnews" class="card-img-right flex-auto d-none d-lg-block" data-src="holder.js/200x250?theme=thumb">
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card flex-md-row mb-4 shadow-sm h-md-250">
                        <div class="card-body d-flex flex-column align-items-start">
                            <strong id="forthid" class="d-inline-block mb-2 text-primary">4</strong>
                            <h4 class="mb-0">
                                <a id="forthnewstitle" class="text-dark">NEWS TITLE</a>
                            </h4>
                            <div id="forthdate" class="mb-1 text-muted">DATE</div>
                            <a id="forthnewslink" href="#" target="_blank">Continue reading</a>
                        </div>
                        <img id="forthnews" class="card-img-right flex-auto d-none d-lg-block" data-src="holder.js/200x250?theme=thumb">
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card flex-md-row mb-4 shadow-sm h-md-250">
                        <div class="card-body d-flex flex-column align-items-start">
                            <strong id="fifthid" class="d-inline-block mb-2 text-primary">5</strong>
                            <h4 class="mb-0">
                                <a id="fifthnewstitle" class="text-dark">NEWS TITLE</a>
                            </h4>
                            <div id="fifthdate" class="mb-1 text-muted">DATE</div>
                            <a id="fifthnewslink" href="#" target="_blank">Continue reading</a>
                        </div>
                        <img id="fifthnews" class="card-img-right flex-auto d-none d-lg-block" data-src="holder.js/200x250?theme=thumb">
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card flex-md-row mb-4 shadow-sm h-md-250">
                        <div class="card-body d-flex flex-column align-items-start">
                            <strong id="sixthid" class="d-inline-block mb-2 text-primary">6</strong>
                            <h4 class="mb-0">
                                <a id="sixthnewstitle" class="text-dark">NEWS TITLE</a>
                            </h4>
                            <div id="sixthdate" class="mb-1 text-muted">DATE</div>
                            <a id="sixthnewslink" href="#" target="_blank">Continue reading</a>
                        </div>
                        <img id="sixthnews" class="card-img-right flex-auto d-none d-lg-block" data-src="holder.js/200x250?theme=thumb">
                    </div>
                </div>
            </div>

            <h2>OLDER NEWS</h2>
            <hr>
            <div id="stage">STAGE</div>
            <hr>

            <footer class="container">
                    <p class="float-right"><a href="#">Back to top</a></p>
                    <p>Create by <a href="https://www.facebook.com/surawit.wiriyasrisuwatthana.7">KAKDEN</a></p>
                    <p>Thanks to <a href="https://getbootstrap.com/">Bootstrap</a></p>
                </footer>
        </div>
    </div>
</body>

<script>
    $(document).ready(function () {
        $("body").ready(function (event) {
            $.getJSON('https://www.kku.ac.th/ikku/api/news/services/topNews.php', crossorigin="anonymous", function (jd, index) {

                var firid = document.querySelector('#firstid');
                var secid = document.querySelector('#secondid');
                var thiid = document.querySelector('#thirdid');
                var forid = document.querySelector('#forthid');
                var fifid = document.querySelector('#fifthid');
                var sixid = document.querySelector('#sixthid');

                var firdate = document.querySelector('#firstdate');
                var secdate = document.querySelector('#seconddate');
                var thidate = document.querySelector('#thirddate');
                var fordate = document.querySelector('#forthdate');
                var fifdate = document.querySelector('#fifthdate');
                var sixdate = document.querySelector('#sixthdate');

                var firtitle = document.querySelector('#firstnewstitle');
                var sectitle = document.querySelector('#secondnewstitle');
                var thititle = document.querySelector('#thirdnewstitle');
                var fortitle = document.querySelector('#forthnewstitle');
                var fiftitle = document.querySelector('#fifthnewstitle');
                var sixtitle = document.querySelector('#sixthnewstitle');

                var firnews = document.querySelector('#firstnews');
                var secnews = document.querySelector('#secondnews');
                var thinews = document.querySelector('#thirdnews');
                var fornews = document.querySelector('#forthnews');
                var fifnews = document.querySelector('#fifthnews');
                var sixnews = document.querySelector('#sixthnews');

                var firlink = document.querySelector('#firstnewslink');
                var seclink = document.querySelector('#secondnewslink');
                var thilink = document.querySelector('#thirdnewslink');
                var forlink = document.querySelector('#forthnewslink');
                var fiflink = document.querySelector('#fifthnewslink');
                var sixlink = document.querySelector('#sixthnewslink');

                var j = jd['news'];

                firnews.setAttribute('src', j[0].pictitle);
                firlink.setAttribute('href', j[0].url);
                firtitle.textContent = j[0].title;
                firid.textContent = j[0].id;
                firdate.textContent = j[0].date;
                firnews.style.display = "block";
                firnews.style.margin = "0 auto";

                secnews.setAttribute('src', j[1].pictitle);
                seclink.setAttribute('href', j[1].url);
                sectitle.textContent = j[1].title;
                secid.textContent = j[1].id;
                secdate.textContent = j[1].date;
                secnews.style.display = "block";
                secnews.style.margin = "0 auto";

                thinews.setAttribute('src', j[2].pictitle);
                thilink.setAttribute('href', j[2].url);
                thititle.textContent = j[2].title;
                thiid.textContent = j[2].id;
                thidate.textContent = j[2].date;
                thinews.style.display = "block";
                thinews.style.margin = "0 auto";

                fornews.setAttribute('src', j[3].pictitle);
                forlink.setAttribute('href', j[3].url);
                fortitle.textContent = j[3].title;
                forid.textContent = j[3].id;
                fordate.textContent = j[3].date;
                fornews.style.display = "block";
                fornews.style.margin = "0 auto";

                fifnews.setAttribute('src', j[4].pictitle);
                fiflink.setAttribute('href', j[4].url);
                fiftitle.textContent = j[4].title;
                fifid.textContent = j[4].id;
                fifdate.textContent = j[4].date;
                fifnews.style.display = "block";
                fifnews.style.margin = "0 auto";

                sixnews.setAttribute('src', j[5].pictitle);
                sixlink.setAttribute('href', j[5].url);
                sixtitle.textContent = j[5].title;
                sixid.textContent = j[5].id;
                sixdate.textContent = j[5].date;
                sixnews.style.display = "block";
                sixnews.style.margin = "0 auto";

                var result = "<ul>";
                var j = jd['news'];
                for (i = 6; i < 30; i++) {
                    result += '<li><a href="' + j[i].url + '" target="_blank" >' + j[i].title + '</a></li>';
                }
                result += "</ul>";
                $('#stage').html(result);   
            });
        });
    });

    var time;
    function myFunction() {
        time = setTimeout(showPage, 700);
    }
    function showPage() {
        document.getElementById("loader").style.display = "none";
        document.getElementById("myDiv").style.display = "block";
    }
</script>

<script>
        // When the user clicks anywhere outside of the modal, close it
        var modal = document.getElementById('loginmodal');
        var regismodal = document.getElementById('regismodal')
        window.onclick = function (event) {
          if (event.target == modal || event.target == regismodal) {
            modal.style.display = "none";
            regismodal.style.display = "none";
          }
        }
    
        var config = {
          apiKey: "AIzaSyBFZXdxYWHyYK3BjJZXj1ZGl3izJ8YIohA",
          authDomain: "my-syllabus-api.firebaseapp.com",
          databaseURL: "https://my-syllabus-api.firebaseio.com",
          projectId: "my-syllabus-api",
          storageBucket: "my-syllabus-api.appspot.com",
          messagingSenderId: "1075881504071"
        };
        firebase.initializeApp(config);
    
        var regisBtn = document.getElementById('regis');
        regisBtn.addEventListener('click', saveData);
    
        function saveData() {
          var firstname = document.getElementById('fname');
          var lastname = document.getElementById('lname');
          var id = document.getElementById('ID');
          var email = document.getElementById('email');
          var psword = document.getElementById('password');
          insertData(fname.value, lname.value, ID.value, email.value, password.value)
        }
    
        function insertData(fname,lname,ID,email,password) {
          var firebaseRef = firebase.database().ref("users");
          firebaseRef.push({
            firstname: fname,
            lastname: lname,
            id: ID,
            email: email,
            psword: password
          });
          console.log("Insert Success");
          signUp();
          alert("Register Succesfull");
        }
    
        function signUp() {
          var emailLogin = document.getElementById('email').value;
          var passwordLogin = document.getElementById('password').value;
          firebase.auth().createUserWithEmailAndPassword(emailLogin, passwordLogin).catch(function (error){
            var errorCode = error.code;
            var errorMessage = error.message;
            if (errorCode === 'auth/wrong-password') {
              alert('Wrong password');
            } else {
              alert(errorMessage)
            }
            console.log(error);
          });
        }
    
        function signIn() {
          var emailLogin = document.getElementById('emailLogin').value;
          var passwordLogin = document.getElementById('passwordLogin').value;
          firebase.auth().signInWithEmailAndPassword(emailLogin, passwordLogin).catch(function (error) {
            var errorCode = error.code;
            var errorMessage = error.message;
            if (errorCode === 'auth/wrong-password') {
              alert('Wrong password');
            } else {
              alert(errorMessage)
            }
            console.log(error);
          });
          alert('logged in');
        }
    
        document.getElementById('loginBtn').addEventListener('click', signIn);
        var signInBtn = document.getElementById('signInBtn');
        var singOutBtn = document.getElementById('signOutBtn');
        firebase.auth().onAuthStateChanged(firebaseUser => {
                if(firebaseUser) {
                    console.log(firebaseUser);
                    signInBtn.classList.add('hide');
                    signOutBtn.classList.remove('hide');
                    modal.classList.add('hide');
                    emailNav.classList.remove('hide');
                    console.log("logged in");
                    console.log(firebaseUser.email);
                    console.log(firebaseUser.uid);
                    emailNav.innerHTML = firebaseUser.email;
                    console.log(firebaseUser.displayName);
                } else {
                    emailNav.classList.add('hide');
                    signInBtn.classList.remove('hide');
                    signOutBtn.classList.add('hide');
                    console.log('not logged in');
                }
            });
    
            signOutBtn.addEventListener('click', e => {
                firebase.auth().signOut();
                alert("Log out Successfully!!");
            });
      </script>

</body>

</html>